\chapter{Conclusion and Future Work}
This thesis presented an infrastructure dedicated to MPI Performance Engineering, enabling introspection of MPI runtimes.
To serve that purpose, this infrastructure utilized the MPI Tools Information Interface, introduced in the MPI 3.0 standard.
\par I discussed how the TAU Performance System and MVAPICH2 could be extended to fully exploit features offered by MPI\_T. I demonstrated different usage scenarios based on specific sets of MPI\_T Performance and Control Variables exported by MVAPICH2. The results produced by our experiments on a combination of synthetic and production applications validate our approach and open broad perspectives for future research.
\par With Caliper, I presented an infrastructure that enables performance introspection through MPI\_T. As compared to TAU, I chose to experiment with a different strategy to sample PVARs. I demonstrated how this strategy could lead to a more meaningful way to analyze PVARs, even if the overheads associated with this strategy were high.
\par Turning to the future, it is interesting to consider that MPI\_T provides an opportunity to perform autotuning on an \textit{extremely} fine-grained level --- right down to message-level granularity. MVAPICH2 exports an environment variable called \verb+MV2_RNDV_PROTOCOL+ that determines the \textit{rendezvous} protocol used on RDMA capable systems --- \verb+RDMA_WRITE+ or \verb+RDMA_READ+. Our experiments with microbenchmarks suggest that using the right RDMA protocol for a communicating pair of processes at a given callsite can significantly improve \textit{rendezvous} nonblocking point-to-point performance. 
\par Detecting the runtime ordering of the posting of the nonblocking send, receive, and the corresponding wait operation is critical in determining the right RDMA protocol to use for \textit{rendezvous} communication. The \textit{rendezvous} protocol typically involves the exchange of control messages between the sender and receiver. MPI\_T can potentially help in detecting this exchange of control messages and in ultimately determining how to tune the protocol at a fine-grained level. 
\par We must first verify that tuning the \textit{rendezvous} protocol at a fine-grained level can indeed lead to performance benefits. However, MVAPICH2 does not have support for tuning the \verb+MV2_RNDV_PROTOCOL+ at a fine-grained level. The value of this variable is common across MPI processes and MPI callsites and cannot be changed at runtime. So, we resort to simulating the \textit{rendezvous} protocol using a trace-replay tool such as TraceR~\cite{TraceR} in order to confirm or reject this hypothesis. We hope to show that fine-grained tuning of the \textit{rendezvous} protocol does indeed lead to performance benefits by post-processing application traces. Through simulation, we also hope to demonstrate a mechanism to profile and tune the \textit{rendezvous} protocol dynamically at runtime.
\par We plan to enrich our infrastructure by also exploring the following areas of research:
\begin{itemize}
	\item Develop an infrastructure to express autotuning policies in a more generic fashion
        \item Enrich MPI\_T support in MVAPICH2 to enable introspection and tuning for a wide range of applications and communication patterns
	\item Study the challenges in providing an interactive performance engineering functionality for end users
\end{itemize}

\par With respect to future Caliper research, it currently lacks a mechanism to tune the MPI library at runtime using the MPI\_T interface. We plan to add support for MPI\_T based autotuning in Caliper. A prospective research idea is to integrate Caliper with TAU through Caliper's tool API. This way, Caliper can leverage TAU's MPI\_T infrastructure for performance autotuning or recommendations. Caliper also lacks a proper tool for performance analysis --- through this integration, performance data collected through Caliper can be analyzed using TAU's rich support for profiling and tracing tools.
